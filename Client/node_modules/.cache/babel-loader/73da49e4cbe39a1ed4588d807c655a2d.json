{"ast":null,"code":"import _regeneratorRuntime from\"D:/Project Web/Project Web/PROJECT 12 (Only MERN)/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Project Web/Project Web/PROJECT 12 (Only MERN)/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{postAPI}from'../../apis/Axios';export var signup=function signup(form){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:'ALERT',payload:{loading:true}});_context.next=4;return postAPI('auth/signup',form);case 4:res=_context.sent;dispatch({type:'AUTH',payload:{token:res.data.access_token,user:res.data.user}});localStorage.setItem('FirstLogin',true);dispatch({type:'ALERT',payload:{success:res.data.msg}});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);dispatch({type:'ALERT',payload:{error:_context.t0.response.data.msg}});case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(form){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch({type:'ALERT',payload:{loading:true}});_context2.next=4;return postAPI('auth/login',form);case 4:res=_context2.sent;dispatch({type:'AUTH',payload:{token:res.data.access_token,user:res.data.user}});if(form.remember)localStorage.setItem('FirstLogin',true);else sessionStorage.setItem('FirstLogin',true);dispatch({type:'ALERT',payload:{success:res.data.msg}});_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);dispatch({type:'ALERT',payload:{error:_context2.t0.response.data.msg}});case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;localStorage.removeItem('FirstLogin');_context3.next=4;return postAPI('auth/logout');case 4:window.location.href='/';_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);dispatch({type:'ALERT',payload:{error:_context3.t0.response.data.msg}});case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var changePassword=function changePassword(auth,form){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return postAPI(\"/auth/changepw\",{form:form},auth.token);case 3:res=_context4.sent;dispatch({type:'ALERT',payload:{success:res.data.msg}});_context4.next=11;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);dispatch({type:'WRONG_PASSWORD',payload:true});dispatch({type:'ALERT',payload:{error:_context4.t0.response.data.msg}});case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var refreshToken=function refreshToken(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var firstLogin,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:firstLogin=localStorage.getItem('FirstLogin')||sessionStorage.getItem('FirstLogin');if(!firstLogin){_context5.next=14;break;}_context5.prev=2;dispatch({type:'ALERT',payload:{loading:true}});_context5.next=6;return postAPI('auth/refresh_token');case 6:res=_context5.sent;dispatch({type:'AUTH',payload:{token:res.data.access_token,user:res.data.user}});dispatch({type:'ALERT',payload:{}});_context5.next=14;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](2);dispatch({type:'ALERT',payload:{error:_context5.t0.response.data.msg}});case 14:case\"end\":return _context5.stop();}}},_callee5,null,[[2,11]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};","map":{"version":3,"sources":["D:/Project Web/Project Web/PROJECT 12 (Only MERN)/Client/src/store/actions/authAction.js"],"names":["postAPI","signup","form","dispatch","type","payload","loading","res","token","data","access_token","user","localStorage","setItem","success","msg","error","response","login","remember","sessionStorage","logout","removeItem","window","location","href","changePassword","auth","refreshToken","firstLogin","getItem"],"mappings":"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","sourcesContent":["import {postAPI} from '../../apis/Axios'\r\n\r\nexport const signup = (form) => async (dispatch) => {\r\n    try {\r\n        dispatch({type: 'ALERT', payload: {loading: true}})\r\n        const res = await postAPI('auth/signup', form)\r\n        dispatch({type: 'AUTH', payload: {\r\n            token: res.data.access_token,\r\n            user: res.data.user\r\n        }})\r\n        localStorage.setItem('FirstLogin',true)\r\n        dispatch({type: 'ALERT', payload: {success: res.data.msg}})\r\n\r\n    } catch (err) {       \r\n        dispatch({type: 'ALERT', payload: {error: err.response.data.msg}})\r\n    }\r\n}\r\n\r\nexport const login = (form) => async (dispatch) => {\r\n    try {\r\n        dispatch({type: 'ALERT', payload: {loading: true}})\r\n        const res = await postAPI('auth/login', form)\r\n        dispatch({type: 'AUTH', payload: {\r\n            token: res.data.access_token,\r\n            user: res.data.user\r\n        }})\r\n\r\n        if (form.remember) localStorage.setItem('FirstLogin',true)\r\n        else sessionStorage.setItem('FirstLogin',true)\r\n\r\n        dispatch({type: 'ALERT', payload: {success: res.data.msg}})\r\n\r\n    } catch (err){\r\n        dispatch({type: 'ALERT', payload: {error: err.response.data.msg}})\r\n    }\r\n}\r\n\r\nexport const logout = () => async (dispatch) => {\r\n    try {\r\n        localStorage.removeItem('FirstLogin')\r\n        await postAPI('auth/logout')\r\n        window.location.href = '/'\r\n\r\n    } catch (err) {\r\n        dispatch({type: 'ALERT', payload: {error: err.response.data.msg}})\r\n    }\r\n}\r\n\r\nexport const changePassword = (auth, form) => async (dispatch) => {\r\n    try {\r\n        const res = await postAPI(`/auth/changepw`, {form}, auth.token)\r\n        dispatch({type: 'ALERT', payload: {success: res.data.msg}})\r\n\r\n    } catch(err) {\r\n        dispatch({type: 'WRONG_PASSWORD', payload: true})\r\n        dispatch({type: 'ALERT', payload: {error: err.response.data.msg}})\r\n    }\r\n}\r\n\r\nexport const refreshToken = () => async (dispatch) => {\r\n    const firstLogin = localStorage.getItem('FirstLogin') || sessionStorage.getItem('FirstLogin')\r\n    if(firstLogin) {\r\n        try {\r\n            dispatch({type: 'ALERT', payload: {loading: true}})\r\n            const res = await postAPI('auth/refresh_token')\r\n            dispatch({type: 'AUTH', payload: {\r\n                token: res.data.access_token,\r\n                user: res.data.user\r\n            }})\r\n            dispatch({type: 'ALERT', payload: {}})\r\n            \r\n        } catch(err){\r\n            dispatch({type: 'ALERT', payload: {error: err.response.data.msg}})\r\n        }\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}