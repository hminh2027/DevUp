{"ast":null,"code":"var _jsxFileName = \"D:\\\\Project Web\\\\PROJECT 12 (Only MERN)\\\\Client\\\\client\\\\src\\\\components\\\\util\\\\Cropper.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport { useDispatch } from 'react-redux';\nimport styles from './Cropper.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Cropper = ({\n  src,\n  setImage,\n  setCropImage\n}) => {\n  _s();\n\n  const dispatch = useDispatch();\n  const [crop, setCrop] = useState({\n    aspect: 1 / 1,\n    width: 200,\n    height: 200\n  });\n  const [image, setLocalImage] = useState(null);\n  const [link, setLink] = useState(null);\n  useEffect(() => {\n    setLink(URL.createObjectURL(src));\n  }, [src]);\n\n  function getCroppedImg() {\n    const canvas = document.createElement(\"canvas\");\n    const scaleX = image.naturalWidth / image.width;\n    const scaleY = image.naturalHeight / image.height;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    const ctx = canvas.getContext(\"2d\"); // New lines to be added\n\n    const pixelRatio = window.devicePixelRatio;\n    canvas.width = crop.width * pixelRatio;\n    canvas.height = crop.height * pixelRatio;\n    ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n    ctx.imageSmoothingQuality = \"high\";\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    canvas.toBlob(blob => {\n      if (blob) setImage({ ...image,\n        avatar: blob\n      });else dispatch({\n        type: 'ALERT',\n        payload: {\n          error: 'Please crop the image!'\n        }\n      });\n    });\n    setCropImage(null);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.crop_heading,\n      children: \"Crop Image\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ReactCrop, {\n      className: styles.crop_img,\n      crop: crop,\n      src: link,\n      onChange: setCrop,\n      onImageLoaded: setLocalImage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onClick: getCroppedImg,\n      className: styles.crop_btn,\n      children: \"Crop\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Cropper, \"2TChMyqC5f//j3OnzsaMo8Nm8iw=\", false, function () {\n  return [useDispatch];\n});\n\n_c = Cropper;\nexport default Cropper;\n\nvar _c;\n\n$RefreshReg$(_c, \"Cropper\");","map":{"version":3,"sources":["D:/Project Web/PROJECT 12 (Only MERN)/Client/client/src/components/util/Cropper.js"],"names":["React","useEffect","useState","ReactCrop","useDispatch","styles","Cropper","src","setImage","setCropImage","dispatch","crop","setCrop","aspect","width","height","image","setLocalImage","link","setLink","URL","createObjectURL","getCroppedImg","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","pixelRatio","window","devicePixelRatio","setTransform","imageSmoothingQuality","drawImage","x","y","toBlob","blob","avatar","type","payload","error","container","crop_heading","crop_img","crop_btn"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport ReactCrop from 'react-image-crop';\r\nimport 'react-image-crop/dist/ReactCrop.css';\r\nimport { useDispatch } from 'react-redux';\r\nimport styles from './Cropper.module.css'\r\n\r\nconst Cropper = ({ src, setImage, setCropImage }) => {\r\n    const dispatch = useDispatch();\r\n    const [crop, setCrop] = useState({\r\n        aspect: 1/1,\r\n        width: 200,\r\n        height: 200\r\n    });\r\n    const [image, setLocalImage] = useState(null);\r\n    const [link, setLink] = useState(null);\r\n    \r\n    useEffect(()=>{\r\n        setLink(URL.createObjectURL(src))\r\n    },[src])\r\n\r\n    function getCroppedImg() {\r\n        const canvas = document.createElement(\"canvas\");\r\n        const scaleX = image.naturalWidth / image.width;\r\n        const scaleY = image.naturalHeight / image.height;\r\n        canvas.width = crop.width;\r\n        canvas.height = crop.height;\r\n        const ctx = canvas.getContext(\"2d\");\r\n      \r\n        // New lines to be added\r\n        const pixelRatio = window.devicePixelRatio;\r\n        canvas.width = crop.width * pixelRatio;\r\n        canvas.height = crop.height * pixelRatio;\r\n        ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\r\n        ctx.imageSmoothingQuality = \"high\";\r\n      \r\n        ctx.drawImage(\r\n          image,\r\n          crop.x * scaleX,\r\n          crop.y * scaleY,\r\n          crop.width * scaleX,\r\n          crop.height * scaleY,\r\n          0,\r\n          0,\r\n          crop.width,\r\n          crop.height\r\n        );\r\n        canvas.toBlob(\r\n            blob => {\r\n                if(blob) setImage({...image,avatar: blob})\r\n                else dispatch({type: 'ALERT' , payload: {error: 'Please crop the image!'}});\r\n            }\r\n        );\r\n        setCropImage(null);\r\n    }\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.crop_heading}>Crop Image</div>\r\n            <ReactCrop className={styles.crop_img} crop={crop} src={link} onChange={setCrop} onImageLoaded={setLocalImage} />\r\n            <div onClick={getCroppedImg} className={styles.crop_btn}>Crop</div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Cropper\r\n"]},"metadata":{},"sourceType":"module"}