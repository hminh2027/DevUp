{"ast":null,"code":"import _slicedToArray from\"D:/Project Web/Project Web/PROJECT 12 (Only MERN)/Client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{Link}from'react-router-dom';import{updateComment}from'../../../store/actions/commentAction';import CommentOption from'./CommentOption';import{CgMoreAlt}from'react-icons/cg';import{GoReply}from'react-icons/go';import moment from'moment';import Avatar from'../../util/Avatar';import TextareaAutosize from'react-textarea-autosize';import styles from'./CommentCard.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentCard=function CommentCard(_ref){var post=_ref.post,comment=_ref.comment,setOnReply=_ref.setOnReply;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showOption=_useState2[0],setShowOption=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),body=_useState4[0],setBody=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showMore=_useState6[0],setShowMore=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLong=_useState8[0],setIsLong=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isEdit=_useState10[0],setIsEdit=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),onSubmit=_useState12[0],setOnSubmit=_useState12[1];var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth;useEffect(function(){if(onSubmit)submitHandler();},[onSubmit]);useEffect(function(){setBody(comment.body);setOnReply(false);},[comment.body,isEdit]);useEffect(function(){if(body&&body.length>250){setIsLong(true);setShowMore(true);}else setIsLong(false);},[body]);var submitHandler=function submitHandler(){var trimBody=body.trim();if(trimBody=='')return setOnSubmit(false);dispatch(updateComment(auth,trimBody,post,comment));setIsEdit(false);setOnSubmit(false);};var checkHandler=function checkHandler(e){if(e.charCode==13){e.preventDefault();setOnSubmit(true);}};var replyHandler=function replyHandler(){setOnReply(comment);};return/*#__PURE__*/_jsxs(\"div\",{className:styles.cmt_wrapper,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.avatar,children:/*#__PURE__*/_jsx(Avatar,{id:comment.user._id,src:comment.user.avatar,diameter:comment.reply?'2rem':'2.5rem'})}),/*#__PURE__*/_jsx(\"div\",{className:styles.content_wrapper,children:/*#__PURE__*/_jsxs(\"div\",{style:{width:\"\".concat(isEdit?'auto':'fit-content')},className:styles.content,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.name,children:/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(comment.user._id),children:comment.user.username})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.text,children:[isEdit?/*#__PURE__*/_jsx(TextareaAutosize,{value:body,className:styles.input,onKeyPress:checkHandler,spellCheck:\"false\",onChange:function onChange(e){return setBody(e.target.value);},placeholder:\"Write your comment here...\"}):isLong&&showMore?\"\".concat(body.slice(0,250),\"... \"):body.trim(),isLong&&(showMore?/*#__PURE__*/_jsx(\"label\",{onClick:function onClick(){return setShowMore(false);},className:styles.toggle_text,children:\"[show more]\"}):/*#__PURE__*/_jsx(\"label\",{onClick:function onClick(){return setShowMore(true);},className:styles.toggle_text,children:\"[hidden]\"})),isEdit&&/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return setIsEdit(false);},className:styles.cancel,children:\"Cancel\"})]}),(auth.user._id===post.user._id||auth.user._id===comment.user._id)&&/*#__PURE__*/_jsxs(\"div\",{style:{opacity:\"\".concat(showOption?'1':'.3')},onClick:function onClick(){return setShowOption(!showOption);},className:styles.option_btn,children:[/*#__PURE__*/_jsx(CgMoreAlt,{}),/*#__PURE__*/_jsx(CommentOption,{setIsEdit:setIsEdit,comment:comment,post:post,isShow:showOption,setIsShow:setShowOption})]}),!isEdit&&/*#__PURE__*/_jsx(\"div\",{onClick:replyHandler,className:styles.reply,children:/*#__PURE__*/_jsx(GoReply,{className:styles.icon})})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.time,children:moment(comment.createdAt).fromNow().replace(/(ago)+/g,'')})]});};export default CommentCard;","map":{"version":3,"sources":["D:/Project Web/Project Web/PROJECT 12 (Only MERN)/Client/src/components/post/comment/CommentCard.js"],"names":["React","useEffect","useState","useDispatch","useSelector","Link","updateComment","CommentOption","CgMoreAlt","GoReply","moment","Avatar","TextareaAutosize","styles","CommentCard","post","comment","setOnReply","dispatch","showOption","setShowOption","body","setBody","showMore","setShowMore","isLong","setIsLong","isEdit","setIsEdit","onSubmit","setOnSubmit","state","auth","submitHandler","length","trimBody","trim","checkHandler","e","charCode","preventDefault","replyHandler","cmt_wrapper","avatar","user","_id","reply","content_wrapper","width","content","name","username","text","input","target","value","slice","toggle_text","cancel","opacity","option_btn","icon","time","createdAt","fromNow","replace"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport {useDispatch, useSelector} from 'react-redux'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport { updateComment } from '../../../store/actions/commentAction'\r\n\r\nimport CommentOption from './CommentOption'\r\n\r\nimport {CgMoreAlt} from 'react-icons/cg'\r\nimport {GoReply} from 'react-icons/go'\r\n\r\nimport moment from 'moment'\r\nimport Avatar from '../../util/Avatar'\r\nimport TextareaAutosize from 'react-textarea-autosize'\r\n\r\nimport styles from './CommentCard.module.css'\r\n\r\nconst CommentCard = ({post, comment, setOnReply}) => {\r\n    const dispatch = useDispatch()\r\n\r\n    const [showOption, setShowOption] = useState(false)\r\n    const [body, setBody] = useState('')\r\n    const [showMore, setShowMore] = useState(false)\r\n    const [isLong, setIsLong] = useState(false)\r\n    const [isEdit, setIsEdit] = useState(false)\r\n    const [onSubmit, setOnSubmit] = useState(false)\r\n\r\n    const {auth} = useSelector(state=>state)\r\n\r\n\r\n    useEffect(()=>{\r\n        if(onSubmit) submitHandler()\r\n    },[onSubmit])\r\n    \r\n    useEffect(()=>{\r\n        setBody(comment.body)\r\n        setOnReply(false)\r\n\r\n    },[comment.body, isEdit])\r\n\r\n    useEffect(()=> {\r\n        if(body && body.length > 250) {\r\n            setIsLong(true)\r\n            setShowMore(true)\r\n        }\r\n        else setIsLong(false)\r\n        \r\n    },[body])\r\n\r\n    const submitHandler = () => {\r\n        const trimBody = body.trim()\r\n        if(trimBody=='') return setOnSubmit(false)\r\n        dispatch(updateComment(auth, trimBody, post, comment))\r\n        setIsEdit(false)\r\n        setOnSubmit(false)\r\n    }\r\n\r\n    const checkHandler = (e) => {\r\n        if(e.charCode == 13) {\r\n            e.preventDefault()\r\n            setOnSubmit(true)\r\n        }\r\n    }\r\n\r\n    const replyHandler = () => {\r\n        setOnReply(comment)\r\n    }\r\n\r\n    return (\r\n        <div className={styles.cmt_wrapper}>\r\n            <div className={styles.avatar}>\r\n                <Avatar id={comment.user._id} src={comment.user.avatar} diameter={comment.reply ? '2rem' :'2.5rem'} />\r\n            </div>\r\n            <div className={styles.content_wrapper}>\r\n                <div style={{width: `${isEdit? 'auto' : 'fit-content'}`}} className={styles.content}>\r\n                    <div className={styles.name}>\r\n                        <Link to={`/profile/${comment.user._id}`} >\r\n                            {comment.user.username}\r\n                        </Link>\r\n                    </div>\r\n                    <div className={styles.text}>\r\n                        {isEdit ? \r\n                        <TextareaAutosize value={body} className={styles.input} onKeyPress={checkHandler} spellCheck='false' onChange={e=>setBody(e.target.value)} placeholder='Write your comment here...' />\r\n                        : \r\n                        isLong && showMore ?\r\n                        `${body.slice(0,250)}... ` : \r\n                        body.trim()\r\n                        }\r\n                        {isLong && (showMore ? \r\n                        <label onClick={()=>setShowMore(false)} className={styles.toggle_text}>[show more]</label> : \r\n                        <label onClick={()=>setShowMore(true)} className={styles.toggle_text}>[hidden]</label>\r\n                        )}\r\n                        {isEdit && <div onClick={()=>setIsEdit(false)} className={styles.cancel}>Cancel</div>}\r\n                    </div>\r\n                    {(auth.user._id === post.user._id || auth.user._id ===  comment.user._id) && \r\n                    <div style={{opacity: `${showOption ? '1' : '.3'}`}} onClick={()=>setShowOption(!showOption)} className={styles.option_btn}>\r\n                        <CgMoreAlt/>\r\n                        <CommentOption setIsEdit={setIsEdit} comment={comment} post={post} isShow={showOption} setIsShow={setShowOption} />\r\n                    </div>\r\n                    }\r\n                    {!isEdit && <div onClick={replyHandler} className={styles.reply}><GoReply className={styles.icon} /></div>}\r\n                </div>\r\n            </div>           \r\n            <div className={styles.time}>{moment(comment.createdAt).fromNow().replace(/(ago)+/g , '')}</div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CommentCard\r\n"]},"metadata":{},"sourceType":"module"}